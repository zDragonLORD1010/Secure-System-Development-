
njsscan: v0.4.3 | Ajin Abraham | opensecurity.in
<table>
<tbody>
<tr><td>RULE ID    </td><td>ejs_ect_template                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 </td></tr>
<tr><td>CWE        </td><td>CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     </td></tr>
<tr><td>OWASP-WEB  </td><td>A1: Injection                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </td></tr>
<tr><td>DESCRIPTION</td><td>The EJS/ECT template has an unescaped variable. Untrusted user input passed to this variable results in Cross Site Scripting (XSS).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              </td></tr>
<tr><td>SEVERITY   </td><td>ERROR                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </td></tr>
<tr><td>FILES      </td><td><table>
<tbody>
<tr><td>File          </td><td>views/app/products.ejs                                </td></tr>
<tr><td>Match Position</td><td>1907 - 1937                                           </td></tr>
<tr><td>Line Number(s)</td><td>51                                                    </td></tr>
<tr><td>Match String  </td><td><pre>&lt;%- output.products[i].code %&gt;</pre>       </td></tr>
<tr><td>File          </td><td>views/app/products.ejs                                </td></tr>
<tr><td>Match Position</td><td>2019 - 2056                                           </td></tr>
<tr><td>Line Number(s)</td><td>53                                                    </td></tr>
<tr><td>Match String  </td><td><pre>&lt;%- output.products[i].description %&gt;</pre></td></tr>
<tr><td>File          </td><td>views/app/products.ejs                                </td></tr>
<tr><td>Match Position</td><td>1797 - 1825                                           </td></tr>
<tr><td>Line Number(s)</td><td>49                                                    </td></tr>
<tr><td>Match String  </td><td><pre>&lt;%- output.products[i].id %&gt;</pre>         </td></tr>
<tr><td>File          </td><td>views/app/products.ejs                                </td></tr>
<tr><td>Match Position</td><td>1851 - 1881                                           </td></tr>
<tr><td>Line Number(s)</td><td>50                                                    </td></tr>
<tr><td>Match String  </td><td><pre>&lt;%- output.products[i].name %&gt;</pre>       </td></tr>
<tr><td>File          </td><td>views/app/products.ejs                                </td></tr>
<tr><td>Match Position</td><td>1963 - 1993                                           </td></tr>
<tr><td>Line Number(s)</td><td>52                                                    </td></tr>
<tr><td>Match String  </td><td><pre>&lt;%- output.products[i].tags %&gt;</pre>       </td></tr>
<tr><td>File          </td><td>views/app/products.ejs                                </td></tr>
<tr><td>Match Position</td><td>721 - 745                                             </td></tr>
<tr><td>Line Number(s)</td><td>20                                                    </td></tr>
<tr><td>Match String  </td><td><pre>&lt;%- output.searchTerm %&gt;</pre>             </td></tr>
</tbody>
</table></td></tr>
</tbody>
</table>
<table>
<tbody>
<tr><td>RULE ID    </td><td>sequelize_tls                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </td></tr>
<tr><td>CWE        </td><td>CWE-319: Cleartext Transmission of Sensitive Information                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 </td></tr>
<tr><td>OWASP-WEB  </td><td>A6: Security Misconfiguration                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </td></tr>
<tr><td>DESCRIPTION</td><td>The Sequelize connection string indicates that database server does not use TLS. Non TLS connections are susceptible to man in the middle (MITM) attacks.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </td></tr>
<tr><td>SEVERITY   </td><td>WARNING                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  </td></tr>
<tr><td>FILES      </td><td><table>
<tbody>
<tr><td>File          </td><td>config/db.js                                                                                                                                                                                                                                                                    </td></tr>
<tr><td>Match Position</td><td>18 - 2                                                                                                                                                                                                                                                                          </td></tr>
<tr><td>Line Number(s)</td><td>1: 8                                                                                                                                                                                                                                                                            </td></tr>
<tr><td>Match String  </td><td><pre>module.exports = {
  username: process.env.MYSQL_USER,
  password: process.env.MYSQL_PASSWORD,
  database: process.env.MYSQL_DATABASE,
  host: process.env.MYSQL_HOST || &#x27;mysql-db&#x27;,
  port: process.env.MYSQL_PORT || 3306,
  dialect: &#x27;mysql&#x27;
}</pre></td></tr>
</tbody>
</table></td></tr>
</tbody>
</table>
<table>
<tbody>
<tr><td>RULE ID    </td><td>express_open_redirect                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      </td></tr>
<tr><td>CWE        </td><td>CWE-601: URL Redirection to Untrusted Site ('Open Redirect')                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               </td></tr>
<tr><td>OWASP-WEB  </td><td>A1: Injection                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              </td></tr>
<tr><td>DESCRIPTION</td><td>Untrusted user input in redirect() can result in Open Redirect vulnerability. An http parameter may contain a URL value and could cause the web application to redirect the request to the specified URL. By modifying the URL value to a malicious site, an attacker may successfully launch a phishing scam and steal user credentials. Because the server name in the modified link is identical to the original site, phishing attempts have a more trustworthy appearance. Whether this issue poses a vulnerability will be subject to the intended behavior of the application. For example, a search engine might intentionally provide redirects to arbitrary URLs.</td></tr>
<tr><td>SEVERITY   </td><td>ERROR                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      </td></tr>
<tr><td>FILES      </td><td><table>
<tbody>
<tr><td>File          </td><td>core/appHandler.js                      </td></tr>
<tr><td>Match Position</td><td>3 - 30                                  </td></tr>
<tr><td>Line Number(s)</td><td>188                                     </td></tr>
<tr><td>Match String  </td><td><pre>		res.redirect(req.query.url)</pre></td></tr>
</tbody>
</table>                                                                                                                                                                                                                                                                                                  </td></tr>
</tbody>
</table>
<table>
<tbody>
<tr><td>RULE ID    </td><td>node_deserialize                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             </td></tr>
<tr><td>CWE        </td><td>CWE-502: Deserialization of Untrusted Data                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   </td></tr>
<tr><td>OWASP-WEB  </td><td>A8: Insecure Deserialization                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 </td></tr>
<tr><td>DESCRIPTION</td><td>User controlled data in 'unserialize()' or 'deserialize()' function can result in Object Injection or Remote Code Injection.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 </td></tr>
<tr><td>SEVERITY   </td><td>ERROR                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </td></tr>
<tr><td>FILES      </td><td><table>
<tbody>
<tr><td>File          </td><td>core/appHandler.js                                                                                   </td></tr>
<tr><td>Match Position</td><td>18 - 81                                                                                              </td></tr>
<tr><td>Line Number(s)</td><td>218                                                                                                  </td></tr>
<tr><td>Match String  </td><td><pre>		var products = serialize.unserialize(req.files.products.data.toString(&#x27;utf8&#x27;))</pre></td></tr>
</tbody>
</table></td></tr>
</tbody>
</table>
<table>
<tbody>
<tr><td>RULE ID    </td><td>node_xxe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             </td></tr>
<tr><td>CWE        </td><td>CWE-611: Improper Restriction of XML External Entity Reference                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       </td></tr>
<tr><td>OWASP-WEB  </td><td>A4: XML External Entities (XXE)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      </td></tr>
<tr><td>DESCRIPTION</td><td>User controlled data in XML parsers can result in XML External or Internal Entity (XXE) Processing vulnerabilities                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   </td></tr>
<tr><td>SEVERITY   </td><td>ERROR                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </td></tr>
<tr><td>FILES      </td><td><table>
<tbody>
<tr><td>File          </td><td>core/appHandler.js                                                                                                                 </td></tr>
<tr><td>Match Position</td><td>18 - 111                                                                                                                           </td></tr>
<tr><td>Line Number(s)</td><td>235                                                                                                                                </td></tr>
<tr><td>Match String  </td><td><pre>		var products = libxmljs.parseXmlString(req.files.products.data.toString(&#x27;utf8&#x27;), {noent:true,noblanks:true})</pre></td></tr>
</tbody>
</table></td></tr>
</tbody>
</table>
<table>
<tbody>
<tr><td>RULE ID    </td><td>express_lfr_warning                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      </td></tr>
<tr><td>CWE        </td><td>CWE-23: Relative Path Traversal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          </td></tr>
<tr><td>OWASP-WEB  </td><td>A5: Broken Access Control                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </td></tr>
<tr><td>DESCRIPTION</td><td>Untrusted user input in express render() function can result in arbitrary file read if hbs templating is used.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           </td></tr>
<tr><td>SEVERITY   </td><td>WARNING                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  </td></tr>
<tr><td>FILES      </td><td><table>
<tbody>
<tr><td>File          </td><td>routes/app.js                                                                                                            </td></tr>
<tr><td>Match Position</td><td>9 - 65                                                                                                                   </td></tr>
<tr><td>Line Number(s)</td><td>23                                                                                                                       </td></tr>
<tr><td>Match String  </td><td><pre>        res.render(&#x27;app/bulkproducts&#x27;,{legacy:req.query.legacy})</pre>                                    </td></tr>
<tr><td>File          </td><td>routes/app.js                                                                                                            </td></tr>
<tr><td>Match Position</td><td>9 - 11                                                                                                                   </td></tr>
<tr><td>Line Number(s)</td><td>37: 39                                                                                                                   </td></tr>
<tr><td>Match String  </td><td><pre>        res.render(&#x27;app/admin&#x27;, {
            admin: (req.user.role == &#x27;admin&#x27;)
        })</pre></td></tr>
</tbody>
</table></td></tr>
</tbody>
</table>
<table>
<tbody>
<tr><td>RULE ID    </td><td>cookie_session_default                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               </td></tr>
<tr><td>CWE        </td><td>CWE-522: Insufficiently Protected Credentials                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </td></tr>
<tr><td>OWASP-WEB  </td><td>A2: Broken Authentication                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </td></tr>
<tr><td>DESCRIPTION</td><td>Consider changing the default session cookie name. An attacker can use it to fingerprint the server and target attacks accordingly.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  </td></tr>
<tr><td>SEVERITY   </td><td>INFO                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 </td></tr>
<tr><td>FILES      </td><td><table>
<tbody>
<tr><td>File          </td><td>server.js                                                                                                                                  </td></tr>
<tr><td>Match Position</td><td>9 - 3                                                                                                                                      </td></tr>
<tr><td>Line Number(s)</td><td>23: 28                                                                                                                                     </td></tr>
<tr><td>Match String  </td><td><pre>app.use(session({
  secret: &#x27;keyboard cat&#x27;,
  resave: true,
  saveUninitialized: true,
  cookie: { secure: false }
}))</pre></td></tr>
</tbody>
</table></td></tr>
</tbody>
</table>
<table>
<tbody>
<tr><td>RULE ID    </td><td>cookie_session_no_domain                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             </td></tr>
<tr><td>CWE        </td><td>CWE-522: Insufficiently Protected Credentials                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </td></tr>
<tr><td>OWASP-WEB  </td><td>A2: Broken Authentication                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </td></tr>
<tr><td>DESCRIPTION</td><td>Default session middleware settings: `domain` not set. It indicates the domain of the cookie; use it to compare against the domain of the server in which the URL is being requested. If they match, then check the path attribute next.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             </td></tr>
<tr><td>SEVERITY   </td><td>INFO                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 </td></tr>
<tr><td>FILES      </td><td><table>
<tbody>
<tr><td>File          </td><td>server.js                                                                                                                                  </td></tr>
<tr><td>Match Position</td><td>9 - 3                                                                                                                                      </td></tr>
<tr><td>Line Number(s)</td><td>23: 28                                                                                                                                     </td></tr>
<tr><td>Match String  </td><td><pre>app.use(session({
  secret: &#x27;keyboard cat&#x27;,
  resave: true,
  saveUninitialized: true,
  cookie: { secure: false }
}))</pre></td></tr>
</tbody>
</table></td></tr>
</tbody>
</table>
<table>
<tbody>
<tr><td>RULE ID    </td><td>cookie_session_no_maxage                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             </td></tr>
<tr><td>CWE        </td><td>CWE-613: Insufficient Session Expiration                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             </td></tr>
<tr><td>OWASP-WEB  </td><td>A2: Broken Authentication                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </td></tr>
<tr><td>DESCRIPTION</td><td>Session middleware settings: `maxAge` not set. Use it to set expiration date for cookies.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </td></tr>
<tr><td>SEVERITY   </td><td>INFO                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 </td></tr>
<tr><td>FILES      </td><td><table>
<tbody>
<tr><td>File          </td><td>server.js                                                                                                                                  </td></tr>
<tr><td>Match Position</td><td>9 - 3                                                                                                                                      </td></tr>
<tr><td>Line Number(s)</td><td>23: 28                                                                                                                                     </td></tr>
<tr><td>Match String  </td><td><pre>app.use(session({
  secret: &#x27;keyboard cat&#x27;,
  resave: true,
  saveUninitialized: true,
  cookie: { secure: false }
}))</pre></td></tr>
</tbody>
</table></td></tr>
</tbody>
</table>
<table>
<tbody>
<tr><td>RULE ID    </td><td>cookie_session_no_path                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               </td></tr>
<tr><td>CWE        </td><td>CWE-522: Insufficiently Protected Credentials                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </td></tr>
<tr><td>OWASP-WEB  </td><td>A2: Broken Authentication                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </td></tr>
<tr><td>DESCRIPTION</td><td>Default session middleware settings: `path` not set. It indicates the path of the cookie; use it to compare against the request path. If this and domain match, then send the cookie in the request.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 </td></tr>
<tr><td>SEVERITY   </td><td>INFO                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 </td></tr>
<tr><td>FILES      </td><td><table>
<tbody>
<tr><td>File          </td><td>server.js                                                                                                                                  </td></tr>
<tr><td>Match Position</td><td>9 - 3                                                                                                                                      </td></tr>
<tr><td>Line Number(s)</td><td>23: 28                                                                                                                                     </td></tr>
<tr><td>Match String  </td><td><pre>app.use(session({
  secret: &#x27;keyboard cat&#x27;,
  resave: true,
  saveUninitialized: true,
  cookie: { secure: false }
}))</pre></td></tr>
</tbody>
</table></td></tr>
</tbody>
</table>
<table>
<tbody>
<tr><td>RULE ID    </td><td>cookie_session_no_samesite                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           </td></tr>
<tr><td>CWE        </td><td>cwe-1275                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             </td></tr>
<tr><td>OWASP-WEB  </td><td>A2: Broken Authentication                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </td></tr>
<tr><td>DESCRIPTION</td><td>Default session middleware settings: `sameSite` attribute is not configured to strict or lax. These configurations provides protection against Cross Site Request Forgery attacks.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   </td></tr>
<tr><td>SEVERITY   </td><td>WARNING                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              </td></tr>
<tr><td>FILES      </td><td><table>
<tbody>
<tr><td>File          </td><td>server.js                                                                                                                                  </td></tr>
<tr><td>Match Position</td><td>9 - 3                                                                                                                                      </td></tr>
<tr><td>Line Number(s)</td><td>23: 28                                                                                                                                     </td></tr>
<tr><td>Match String  </td><td><pre>app.use(session({
  secret: &#x27;keyboard cat&#x27;,
  resave: true,
  saveUninitialized: true,
  cookie: { secure: false }
}))</pre></td></tr>
</tbody>
</table></td></tr>
</tbody>
</table>
<table>
<tbody>
<tr><td>RULE ID    </td><td>cookie_session_no_secure                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             </td></tr>
<tr><td>CWE        </td><td>cwe-614                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              </td></tr>
<tr><td>OWASP-WEB  </td><td>A2: Broken Authentication                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </td></tr>
<tr><td>DESCRIPTION</td><td>Default session middleware settings: `secure` not set. It ensures the browser only sends the cookie over HTTPS.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      </td></tr>
<tr><td>SEVERITY   </td><td>WARNING                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              </td></tr>
<tr><td>FILES      </td><td><table>
<tbody>
<tr><td>File          </td><td>server.js                                                                                                                                  </td></tr>
<tr><td>Match Position</td><td>9 - 3                                                                                                                                      </td></tr>
<tr><td>Line Number(s)</td><td>23: 28                                                                                                                                     </td></tr>
<tr><td>Match String  </td><td><pre>app.use(session({
  secret: &#x27;keyboard cat&#x27;,
  resave: true,
  saveUninitialized: true,
  cookie: { secure: false }
}))</pre></td></tr>
</tbody>
</table></td></tr>
</tbody>
</table>